{
//=========Macro generated from canvas: 28b94e1c1e6f43cbab87da322eac90b2/
//=========  (Sun Jan 29 18:16:09 2017) by ROOT version5.34/26
   TCanvas *28b94e1c1e6f43cbab87da322eac90b2 = new TCanvas("28b94e1c1e6f43cbab87da322eac90b2", "",10,45,704,527);
   28b94e1c1e6f43cbab87da322eac90b2->SetHighLightColor(2);
   28b94e1c1e6f43cbab87da322eac90b2->Range(-1062500,1.732428,4562500,4.200949);
   28b94e1c1e6f43cbab87da322eac90b2->SetFillColor(0);
   28b94e1c1e6f43cbab87da322eac90b2->SetBorderMode(0);
   28b94e1c1e6f43cbab87da322eac90b2->SetBorderSize(2);
   28b94e1c1e6f43cbab87da322eac90b2->SetLogy();
   28b94e1c1e6f43cbab87da322eac90b2->SetFrameBorderMode(0);
   28b94e1c1e6f43cbab87da322eac90b2->SetFrameBorderMode(0);
   
   TH1F *h_mpe_spec = new TH1F("h_mpe_spec","MPE Spectrum with Gaussian Fit - nerix_160418_1531",50,-500000,4000000);
   h_mpe_spec->SetBinContent(0,152);
   h_mpe_spec->SetBinContent(1,205);
   h_mpe_spec->SetBinContent(2,478);
   h_mpe_spec->SetBinContent(3,950);
   h_mpe_spec->SetBinContent(4,1631);
   h_mpe_spec->SetBinContent(5,2552);
   h_mpe_spec->SetBinContent(6,3473);
   h_mpe_spec->SetBinContent(7,4092);
   h_mpe_spec->SetBinContent(8,4230);
   h_mpe_spec->SetBinContent(9,4275);
   h_mpe_spec->SetBinContent(10,4091);
   h_mpe_spec->SetBinContent(11,3981);
   h_mpe_spec->SetBinContent(12,3826);
   h_mpe_spec->SetBinContent(13,3948);
   h_mpe_spec->SetBinContent(14,3951);
   h_mpe_spec->SetBinContent(15,4245);
   h_mpe_spec->SetBinContent(16,4304);
   h_mpe_spec->SetBinContent(17,4461);
   h_mpe_spec->SetBinContent(18,4515);
   h_mpe_spec->SetBinContent(19,4680);
   h_mpe_spec->SetBinContent(20,4580);
   h_mpe_spec->SetBinContent(21,4650);
   h_mpe_spec->SetBinContent(22,4618);
   h_mpe_spec->SetBinContent(23,4650);
   h_mpe_spec->SetBinContent(24,4455);
   h_mpe_spec->SetBinContent(25,4541);
   h_mpe_spec->SetBinContent(26,4621);
   h_mpe_spec->SetBinContent(27,4356);
   h_mpe_spec->SetBinContent(28,4292);
   h_mpe_spec->SetBinContent(29,4173);
   h_mpe_spec->SetBinContent(30,4023);
   h_mpe_spec->SetBinContent(31,3966);
   h_mpe_spec->SetBinContent(32,3874);
   h_mpe_spec->SetBinContent(33,3669);
   h_mpe_spec->SetBinContent(34,3641);
   h_mpe_spec->SetBinContent(35,3616);
   h_mpe_spec->SetBinContent(36,3429);
   h_mpe_spec->SetBinContent(37,3282);
   h_mpe_spec->SetBinContent(38,3222);
   h_mpe_spec->SetBinContent(39,3051);
   h_mpe_spec->SetBinContent(40,2968);
   h_mpe_spec->SetBinContent(41,2867);
   h_mpe_spec->SetBinContent(42,2716);
   h_mpe_spec->SetBinContent(43,2599);
   h_mpe_spec->SetBinContent(44,2498);
   h_mpe_spec->SetBinContent(45,2369);
   h_mpe_spec->SetBinContent(46,2209);
   h_mpe_spec->SetBinContent(47,2295);
   h_mpe_spec->SetBinContent(48,2127);
   h_mpe_spec->SetBinContent(49,1945);
   h_mpe_spec->SetBinContent(50,1881);
   h_mpe_spec->SetBinContent(51,28777);
   h_mpe_spec->SetBinError(0,12.32883);
   h_mpe_spec->SetBinError(1,14.31782);
   h_mpe_spec->SetBinError(2,21.86321);
   h_mpe_spec->SetBinError(3,30.82207);
   h_mpe_spec->SetBinError(4,40.38564);
   h_mpe_spec->SetBinError(5,50.51732);
   h_mpe_spec->SetBinError(6,58.93216);
   h_mpe_spec->SetBinError(7,63.96874);
   h_mpe_spec->SetBinError(8,65.03845);
   h_mpe_spec->SetBinError(9,65.38348);
   h_mpe_spec->SetBinError(10,63.96093);
   h_mpe_spec->SetBinError(11,63.09517);
   h_mpe_spec->SetBinError(12,61.85467);
   h_mpe_spec->SetBinError(13,62.83311);
   h_mpe_spec->SetBinError(14,62.85698);
   h_mpe_spec->SetBinError(15,65.15366);
   h_mpe_spec->SetBinError(16,65.60488);
   h_mpe_spec->SetBinError(17,66.79072);
   h_mpe_spec->SetBinError(18,67.19375);
   h_mpe_spec->SetBinError(19,68.41053);
   h_mpe_spec->SetBinError(20,67.6757);
   h_mpe_spec->SetBinError(21,68.19091);
   h_mpe_spec->SetBinError(22,67.95587);
   h_mpe_spec->SetBinError(23,68.19091);
   h_mpe_spec->SetBinError(24,66.74579);
   h_mpe_spec->SetBinError(25,67.38694);
   h_mpe_spec->SetBinError(26,67.97794);
   h_mpe_spec->SetBinError(27,66);
   h_mpe_spec->SetBinError(28,65.51336);
   h_mpe_spec->SetBinError(29,64.59876);
   h_mpe_spec->SetBinError(30,63.42712);
   h_mpe_spec->SetBinError(31,62.97619);
   h_mpe_spec->SetBinError(32,62.24147);
   h_mpe_spec->SetBinError(33,60.57227);
   h_mpe_spec->SetBinError(34,60.3407);
   h_mpe_spec->SetBinError(35,60.13319);
   h_mpe_spec->SetBinError(36,58.55766);
   h_mpe_spec->SetBinError(37,57.28874);
   h_mpe_spec->SetBinError(38,56.76266);
   h_mpe_spec->SetBinError(39,55.23586);
   h_mpe_spec->SetBinError(40,54.47935);
   h_mpe_spec->SetBinError(41,53.54437);
   h_mpe_spec->SetBinError(42,52.11526);
   h_mpe_spec->SetBinError(43,50.98039);
   h_mpe_spec->SetBinError(44,49.98);
   h_mpe_spec->SetBinError(45,48.67237);
   h_mpe_spec->SetBinError(46,47);
   h_mpe_spec->SetBinError(47,47.90616);
   h_mpe_spec->SetBinError(48,46.11941);
   h_mpe_spec->SetBinError(49,44.10215);
   h_mpe_spec->SetBinError(50,43.3705);
   h_mpe_spec->SetBinError(51,169.6378);
   h_mpe_spec->SetEntries(200000);
   h_mpe_spec->SetStats(0);
   
   TF1 *fit_mpe = new TF1("fit_mpe","(([5]/(2*3.14*[2]^2.)^0.5*TMath::Poisson(0,[0])*exp(-0.5*((x-[1])/[2])^2))+([6]/(2*3.14*[8]^2.)^0.5*exp(-0.5*((x-[7])/[8])^2))+([5]/(2*3.14*([2]^2.+1*[4]^2.))^0.5*TMath::Poisson(1,[0])*exp(-0.5*((x-1.0*[3]-[1])/(1.0*[4]^2+[2]^2)^0.5)^2)+[5]/(2*3.14*([2]^2.+2*[4]^2.))^0.5*TMath::Poisson(2,[0])*exp(-0.5*((x-2.0*[3]-[1])/(2.0*[4]^2+[2]^2)^0.5)^2)+[5]/(2*3.14*([2]^2.+3*[4]^2.))^0.5*TMath::Poisson(3,[0])*exp(-0.5*((x-3.0*[3]-[1])/(3.0*[4]^2+[2]^2)^0.5)^2)+[5]/(2*3.14*([2]^2.+4*[4]^2.))^0.5*TMath::Poisson(4,[0])*exp(-0.5*((x-4.0*[3]-[1])/(4.0*[4]^2+[2]^2)^0.5)^2)+[5]/(2*3.14*([2]^2.+5*[4]^2.))^0.5*TMath::Poisson(5,[0])*exp(-0.5*((x-5.0*[3]-[1])/(5.0*[4]^2+[2]^2)^0.5)^2)))*([1]<[3]?1.:0.)*([1]<[7]?1.:0.)*([7]<[3]?1.:0.)",-500000,4000000);
   fit_mpe->SetFillColor(19);
   fit_mpe->SetFillStyle(0);
   fit_mpe->SetLineColor(46);
   fit_mpe->SetLineWidth(3);
   fit_mpe->SetLineStyle(2);
   fit_mpe->SetChisquare(86.04062);
   fit_mpe->SetNDF(41);
   fit_mpe->GetXaxis()->SetLabelFont(42);
   fit_mpe->GetXaxis()->SetLabelSize(0.035);
   fit_mpe->GetXaxis()->SetTitleSize(0.035);
   fit_mpe->GetXaxis()->SetTitleFont(42);
   fit_mpe->GetYaxis()->SetLabelFont(42);
   fit_mpe->GetYaxis()->SetLabelSize(0.035);
   fit_mpe->GetYaxis()->SetTitleSize(0.035);
   fit_mpe->GetYaxis()->SetTitleFont(42);
   fit_mpe->SetParameter(0,2.329429);
   fit_mpe->SetParError(0,0.03761631);
   fit_mpe->SetParLimits(0,0.9,2.5);
   fit_mpe->SetParameter(1,103065.2);
   fit_mpe->SetParError(1,5822.548);
   fit_mpe->SetParLimits(1,-500000,500000);
   fit_mpe->SetParameter(2,223601.8);
   fit_mpe->SetParError(2,4383.322);
   fit_mpe->SetParLimits(2,10000,500000);
   fit_mpe->SetParameter(3,901115);
   fit_mpe->SetParError(3,12773.45);
   fit_mpe->SetParLimits(3,600000,1100000);
   fit_mpe->SetParameter(4,492052.6);
   fit_mpe->SetParError(4,13993.67);
   fit_mpe->SetParLimits(4,300000,900000);
   fit_mpe->SetParameter(5,1.701299e+10);
   fit_mpe->SetParError(5,8.344347e+07);
   fit_mpe->SetParLimits(5,10,2e+11);
   fit_mpe->SetParameter(6,7.032966e+08);
   fit_mpe->SetParError(6,5.942855e+07);
   fit_mpe->SetParLimits(6,10,2e+11);
   fit_mpe->SetParameter(7,500000);
   fit_mpe->SetParError(7,4583.926);
   fit_mpe->SetParLimits(7,1000,500000);
   fit_mpe->SetParameter(8,292353.3);
   fit_mpe->SetParError(8,26679.41);
   fit_mpe->SetParLimits(8,10000,500000);
   h_mpe_spec->GetListOfFunctions()->Add(fit_mpe);
   h_mpe_spec->SetFillStyle(0);
   h_mpe_spec->SetMarkerStyle(20);
   h_mpe_spec->SetMarkerSize(0);
   h_mpe_spec->GetXaxis()->SetTitle("Integrated Charge [e-]");
   h_mpe_spec->GetXaxis()->SetLabelFont(42);
   h_mpe_spec->GetXaxis()->SetLabelSize(0.035);
   h_mpe_spec->GetXaxis()->SetTitleSize(0.035);
   h_mpe_spec->GetXaxis()->SetTitleFont(42);
   h_mpe_spec->GetYaxis()->SetTitle("Counts");
   h_mpe_spec->GetYaxis()->SetLabelFont(42);
   h_mpe_spec->GetYaxis()->SetLabelSize(0.035);
   h_mpe_spec->GetYaxis()->SetTitleSize(0.035);
   h_mpe_spec->GetYaxis()->SetTitleOffset(1.4);
   h_mpe_spec->GetYaxis()->SetTitleFont(42);
   h_mpe_spec->GetZaxis()->SetLabelFont(42);
   h_mpe_spec->GetZaxis()->SetLabelSize(0.035);
   h_mpe_spec->GetZaxis()->SetTitleSize(0.035);
   h_mpe_spec->GetZaxis()->SetTitleFont(42);
   h_mpe_spec->Draw("");
   
   TPaveText *pt = new TPaveText(0.15,0.9374,0.85,0.995,"blNDC");
   pt->SetName("title");
   pt->SetBorderSize(0);
   pt->SetFillColor(0);
   pt->SetFillStyle(0);
   pt->SetTextFont(42);
   TText *text = pt->AddText("MPE Spectrum with Gaussian Fit - nerix_160418_1531");
   pt->Draw();
   
   TF1 *peak_0 = new TF1("peak_0","[0]*exp(-0.5*((x-[1])/[2])^2)",-500000,4000000);
   peak_0->SetFillColor(19);
   peak_0->SetFillStyle(0);
   peak_0->SetLineColor(4);
   peak_0->SetLineWidth(2);
   peak_0->GetXaxis()->SetLabelFont(42);
   peak_0->GetXaxis()->SetLabelSize(0.035);
   peak_0->GetXaxis()->SetTitleSize(0.035);
   peak_0->GetXaxis()->SetTitleFont(42);
   peak_0->GetYaxis()->SetLabelFont(42);
   peak_0->GetYaxis()->SetLabelSize(0.035);
   peak_0->GetYaxis()->SetTitleSize(0.035);
   peak_0->GetYaxis()->SetTitleFont(42);
   peak_0->SetParameter(0,2955.748);
   peak_0->SetParError(0,0);
   peak_0->SetParLimits(0,0,0);
   peak_0->SetParameter(1,103065.2);
   peak_0->SetParError(1,0);
   peak_0->SetParLimits(1,0,0);
   peak_0->SetParameter(2,223601.8);
   peak_0->SetParError(2,0);
   peak_0->SetParLimits(2,0,0);
   peak_0->Draw("same");
   
   TF1 *peak_1 = new TF1("peak_1","[0]*exp(-0.5*((x-[1])/[2])^2)",-500000,4000000);
   peak_1->SetFillColor(19);
   peak_1->SetFillStyle(0);
   peak_1->SetLineColor(2);
   peak_1->SetLineWidth(2);
   peak_1->GetXaxis()->SetLabelFont(42);
   peak_1->GetXaxis()->SetLabelSize(0.035);
   peak_1->GetXaxis()->SetTitleSize(0.035);
   peak_1->GetXaxis()->SetTitleFont(42);
   peak_1->GetYaxis()->SetLabelFont(42);
   peak_1->GetYaxis()->SetLabelSize(0.035);
   peak_1->GetYaxis()->SetTitleSize(0.035);
   peak_1->GetYaxis()->SetTitleFont(42);
   peak_1->SetParameter(0,2848.5);
   peak_1->SetParError(0,0);
   peak_1->SetParLimits(0,0,0);
   peak_1->SetParameter(1,1004180);
   peak_1->SetParError(1,0);
   peak_1->SetParLimits(1,0,0);
   peak_1->SetParameter(2,540475.3);
   peak_1->SetParError(2,0);
   peak_1->SetParLimits(2,0,0);
   peak_1->Draw("same");
   
   TF1 *peak_2 = new TF1("peak_2","[0]*exp(-0.5*((x-[1])/[2])^2)",-500000,4000000);
   peak_2->SetFillColor(19);
   peak_2->SetFillStyle(0);
   peak_2->SetLineColor(8);
   peak_2->SetLineWidth(2);
   peak_2->GetXaxis()->SetLabelFont(42);
   peak_2->GetXaxis()->SetLabelSize(0.035);
   peak_2->GetXaxis()->SetTitleSize(0.035);
   peak_2->GetXaxis()->SetTitleFont(42);
   peak_2->GetYaxis()->SetLabelFont(42);
   peak_2->GetYaxis()->SetLabelSize(0.035);
   peak_2->GetYaxis()->SetTitleSize(0.035);
   peak_2->GetYaxis()->SetTitleFont(42);
   peak_2->SetParameter(0,2453.284);
   peak_2->SetParError(0,0);
   peak_2->SetParLimits(0,0,0);
   peak_2->SetParameter(1,1905295);
   peak_2->SetParError(1,0);
   peak_2->SetParLimits(1,0,0);
   peak_2->SetParameter(2,730909.9);
   peak_2->SetParError(2,0);
   peak_2->SetParLimits(2,0,0);
   peak_2->Draw("same");
   
   TF1 *peak_3 = new TF1("peak_3","[0]*exp(-0.5*((x-[1])/[2])^2)",-500000,4000000);
   peak_3->SetFillColor(19);
   peak_3->SetFillStyle(0);
   peak_3->SetLineColor(7);
   peak_3->SetLineWidth(2);
   peak_3->GetXaxis()->SetLabelFont(42);
   peak_3->GetXaxis()->SetLabelSize(0.035);
   peak_3->GetXaxis()->SetTitleSize(0.035);
   peak_3->GetXaxis()->SetTitleFont(42);
   peak_3->GetYaxis()->SetLabelFont(42);
   peak_3->GetYaxis()->SetLabelSize(0.035);
   peak_3->GetYaxis()->SetTitleSize(0.035);
   peak_3->GetYaxis()->SetTitleFont(42);
   peak_3->SetParameter(0,1580.202);
   peak_3->SetParError(0,0);
   peak_3->SetParLimits(0,0,0);
   peak_3->SetParameter(1,2806410);
   peak_3->SetParError(1,0);
   peak_3->SetParLimits(1,0,0);
   peak_3->SetParameter(2,881104.5);
   peak_3->SetParError(2,0);
   peak_3->SetParLimits(2,0,0);
   peak_3->Draw("same");
   
   TF1 *peak_4 = new TF1("peak_4","[0]*exp(-0.5*((x-[1])/[2])^2)",-500000,4000000);
   peak_4->SetFillColor(19);
   peak_4->SetFillStyle(0);
   peak_4->SetLineColor(5);
   peak_4->SetLineWidth(2);
   peak_4->GetXaxis()->SetLabelFont(42);
   peak_4->GetXaxis()->SetLabelSize(0.035);
   peak_4->GetXaxis()->SetTitleSize(0.035);
   peak_4->GetXaxis()->SetTitleFont(42);
   peak_4->GetYaxis()->SetLabelFont(42);
   peak_4->GetYaxis()->SetLabelSize(0.035);
   peak_4->GetYaxis()->SetTitleSize(0.035);
   peak_4->GetYaxis()->SetTitleFont(42);
   peak_4->SetParameter(0,803.4469);
   peak_4->SetParError(0,0);
   peak_4->SetParLimits(0,0,0);
   peak_4->SetParameter(1,3707525);
   peak_4->SetParError(1,0);
   peak_4->SetParLimits(1,0,0);
   peak_4->SetParameter(2,1009188);
   peak_4->SetParError(2,0);
   peak_4->SetParLimits(2,0,0);
   peak_4->Draw("same");
   
   TF1 *peak_5 = new TF1("peak_5","[0]*exp(-0.5*((x-[1])/[2])^2)",-500000,4000000);
   peak_5->SetFillColor(19);
   peak_5->SetFillStyle(0);
   peak_5->SetLineColor(9);
   peak_5->SetLineWidth(2);
   peak_5->GetXaxis()->SetLabelFont(42);
   peak_5->GetXaxis()->SetLabelSize(0.035);
   peak_5->GetXaxis()->SetTitleSize(0.035);
   peak_5->GetXaxis()->SetTitleFont(42);
   peak_5->GetYaxis()->SetLabelFont(42);
   peak_5->GetYaxis()->SetLabelSize(0.035);
   peak_5->GetYaxis()->SetTitleSize(0.035);
   peak_5->GetYaxis()->SetTitleFont(42);
   peak_5->SetParameter(0,336.4529);
   peak_5->SetParError(0,0);
   peak_5->SetParLimits(0,0,0);
   peak_5->SetParameter(1,4608640);
   peak_5->SetParError(1,0);
   peak_5->SetParLimits(1,0,0);
   peak_5->SetParameter(2,1122754);
   peak_5->SetParError(2,0);
   peak_5->SetParLimits(2,0,0);
   peak_5->Draw("same");
   
   TF1 *peak_6 = new TF1("peak_6","[0]*exp(-0.5*((x-[1])/[2])^2)",-500000,4000000);
   peak_6->SetFillColor(19);
   peak_6->SetFillStyle(0);
   peak_6->SetLineColor(4);
   peak_6->SetLineWidth(2);
   peak_6->GetXaxis()->SetLabelFont(42);
   peak_6->GetXaxis()->SetLabelSize(0.035);
   peak_6->GetXaxis()->SetTitleSize(0.035);
   peak_6->GetXaxis()->SetTitleFont(42);
   peak_6->GetYaxis()->SetLabelFont(42);
   peak_6->GetYaxis()->SetLabelSize(0.035);
   peak_6->GetYaxis()->SetTitleSize(0.035);
   peak_6->GetYaxis()->SetTitleFont(42);
   peak_6->SetParameter(0,959.9546);
   peak_6->SetParError(0,0);
   peak_6->SetParLimits(0,0,0);
   peak_6->SetParameter(1,500000);
   peak_6->SetParError(1,0);
   peak_6->SetParLimits(1,0,0);
   peak_6->SetParameter(2,292353.3);
   peak_6->SetParError(2,0);
   peak_6->SetParLimits(2,0,0);
   peak_6->Draw("same");
   
   pt = new TPaveText(0.55,0.75,0.85,0.85,"blNDC");
   pt->SetBorderSize(0);
   pt->SetFillStyle(0);
   text = pt->AddText("#mu_{SPE} = 9.01e+05 #pm 1.28e+04");
   text = pt->AddText("#sigma_{SPE} = 4.92e+05 #pm 1.40e+04");
   pt->Draw();
   28b94e1c1e6f43cbab87da322eac90b2->Modified();
   28b94e1c1e6f43cbab87da322eac90b2->cd();
   28b94e1c1e6f43cbab87da322eac90b2->SetSelected(28b94e1c1e6f43cbab87da322eac90b2);
}
